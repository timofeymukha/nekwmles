c     module id and name
      integer wmles_id
      character*(*) wmles_name
      parameter(wmles_name='WMLES')

c     initialisation flag
      logical wmles_ifinit

c     Runtime parameter part
c     section id
      integer wmles_sec_id  
c     kappa in the log law
      integer wmles_logkappa_id
c     B in the log law
      integer wmles_logb_id
c     z0 in the rough log law and z1 for temperature
      integer wmles_z0_id, wmles_z1_id
c     inital guess for the wall-shear stress
      integer wmles_guess_id
c     the boundary id identifying walls on which modelling is applied 
      integer wmles_bid_id
c     wall-normal index of the sampling point
      integer wmles_samplingidx_id
c     wether to use wall viscosity or a traction boundary
      integer wmles_ifviscosity_id
c     number of iterations defining the time-scale for averaging
      integer wmles_navrg_id
      
c     Timers
c     total
      integer wmles_tmr_tot_id
c     sampling
      integer wmles_tmr_sampling_id
      
c     The array holding the wall shear stress components.
c     The size is equal to the number of nodes in the domain x3.
c     This is a waste since we actually only need the boundary nodes
c     but it does make indexing much easier, so we keep it this way
c     for now.
      real tau(3, lx1, ly1, lz1, lelv)
c     Same for the wall heat flux
      real heat_flux(lx1, ly1, lz1, lelv)

c     sampled velocity
      real vh(3, lx1, ly1, lz1, lelv)
c     sampled temperature
      real temph(lx1, ly1, lz1, lelv)
c     surface temperature
      real temps(lx1, ly1, lz1, lelv)

c     number of iterations defining the time-scale for averaging
      real wmles_navrg

c     The off-wall index of the sampling point
      integer samplingidx
c     The boundary id for the walls
      integer wallbid
c     Whether to use viscosity at the wall to enforce tau
      logical ifviscosity

c     Common blocks split by variable type
      common /wmlesi/ wmles_sec_id, wmles_logkappa_id, wmles_logb_id,
     $                wmles_z0_id, wmles_z1_id, wmles_guess_id,
     $                wmles_samplingidx_id,
     $                wmles_bid_id, wmles_ifviscosity_id,
     $                wmles_navrg_id,
     $                wmles_tmr_tot_id, wmles_tmr_sampling_id,
     $                samplingidx, wallbid

      common /wmlesl/ wmles_ifinit, ifviscosity

      common /wmlesr/ tau, wmles_navrg, vh, heat_flux, temph, temps
